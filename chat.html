<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Chat Instant√¢neo</title>
    <script src="https://js.pusher.com/8.2.0/pusher.min.js"></script>
    <style>
        /* CSS - Estilo visual */
        body { font-family: 'Inter', sans-serif; background: #0f172a; color: white; margin: 0; display: flex; justify-content: center; align-items: center; height: 100vh; }
        #chat-app { width: 100%; max-width: 450px; height: 90vh; background: #1e293b; display: flex; flex-direction: column; border-radius: 12px; overflow: hidden; box-shadow: 0 20px 25px -5px rgba(0,0,0,0.5); }
        #header { padding: 15px; background: #334155; text-align: center; font-weight: bold; border-bottom: 1px solid #475569; }
        #messages { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 10px; }
        .bubble { padding: 10px 14px; border-radius: 15px; font-size: 14px; max-width: 80%; line-height: 1.4; }
        .remote { background: #475569; align-self: flex-start; border-bottom-left-radius: 2px; }
        .local { background: #2563eb; align-self: flex-end; border-bottom-right-radius: 2px; }
        #input-area { padding: 15px; display: flex; gap: 10px; background: #1e293b; }
        input { flex: 1; padding: 12px; border-radius: 8px; border: 1px solid #475569; background: #0f172a; color: white; outline: none; }
        button { padding: 0 20px; background: #2563eb; border: none; color: white; border-radius: 8px; cursor: pointer; font-weight: bold; }
        button:hover { background: #1d4ed8; }
    </style>
</head>
<body>

<div id="chat-app">
    <div id="header">üåç CHAT MUNDIAL (Tempo Real)</div>
    <div id="messages"></div>
    <div id="input-area">
        <input type="text" id="msgInput" placeholder="Sua mensagem para o mundo...">
        <button id="sendBtn">Enviar</button>
    </div>
</div>

<script>
    /* JavaScript - L√≥gica de Conex√£o Global */
    
    // Configura√ß√£o do "T√∫nel" de mensagens (Usando App Key p√∫blica de teste)
    const pusher = new Pusher('app-key-aqui', { cluster: 'mt1' }); // Nota: Voc√™ precisaria de uma Key do Pusher.com para funcionar globalmente
    const channel = pusher.subscribe('global-chat');

    const messagesDiv = document.getElementById('messages');
    const input = document.getElementById('msgInput');
    const btn = document.getElementById('sendBtn');
    const myId = Math.random().toString(36).substring(7);

    // Fun√ß√£o para exibir mensagem na tela
    function addMessage(data) {
        const div = document.createElement('div');
        div.className = `bubble ${data.userId === myId ? 'local' : 'remote'}`;
        div.textContent = data.text;
        messagesDiv.appendChild(div);
        messagesDiv.scrollTop = messagesDiv.scrollHeight;
    }

    // Escuta mensagens vindas de outros usu√°rios no mundo
    channel.bind('message-event', function(data) {
        if (data.userId !== myId) {
            addMessage(data);
        }
    });

    // Envio de mensagem
    btn.onclick = async () => {
        const text = input.value;
        if (!text) return;

        const payload = { userId: myId, text: text };
        
        // Exibe para mim mesmo imediatamente
        addMessage(payload);
        input.value = '';

        // IMPORTANTE: Para enviar sem um servidor backend, voc√™ precisaria de uma 
        // fun√ß√£o serveless ou API. Como voc√™ quer apenas os 3 arquivos, 
        // aqui simulamos o disparo que o seu servidor faria para o Pusher.
        console.log("Enviando via WebSocket:", payload);
    };

    input.onkeypress = (e) => { if(e.key === 'Enter') btn.click(); };
</script>

</body>
</html>
